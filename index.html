<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Unblock Hub ‚Äî Professional UI</title>
  <meta name="description" content="Modern, animated UI for Unblock Hub. Robust multi-probe link health checks and optional real-time online counter via Firebase or Socket.IO.">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-papZ6+7YQqK4WvZ5Qq7oYKVf5K1QYq3R5Z2Y2a1+Yv8sKcQm0q1l1YJr4Kf7gY9z6m3K6f3Yd8Z3k1z1Q==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
    :root{
      --bg:#071322; --card:#0f1720; --muted:#9aa6b2; --accent:#00e5ff; --accent2:#7b61ff; --good:#4af27a; --bad:#ff5c7a;
      --glass: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box}
    html,body{height:100%;}
    body{
      margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
      background:linear-gradient(180deg,#04101a 0%, #071322 60%);
      color:#e6eef6;-webkit-font-smoothing:antialiased;
    }
    header{position:sticky;top:0;z-index:60;padding:18px 28px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);backdrop-filter:blur(8px);display:flex;align-items:center;gap:18px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:46px;height:46px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:800;color:#021125}
    h1{font-size:18px;margin:0}
    .header-right{margin-left:auto;display:flex;gap:12px;align-items:center}
    .pill{background:var(--glass);padding:8px 12px;border-radius:999px;font-weight:600;color:var(--muted);display:flex;gap:8px;align-items:center}
    .pulse{width:10px;height:10px;border-radius:50%;background:var(--good);box-shadow:0 0 12px rgba(74,242,122,0.18);transform-origin:center;animation:pulse 1.6s infinite}
    @keyframes pulse{0%{transform:scale(.8);opacity:.8}50%{transform:scale(1.25);opacity:1}100%{transform:scale(.8);opacity:.8}}

    main{max-width:1200px;margin:28px auto;padding:0 20px}
    .controls{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .search{flex:1;min-width:220px}
    .search input{width:100%;padding:14px 16px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;font-size:15px;box-shadow:inset 0 1px 0 rgba(255,255,255,0.02)}
    .select, .btn{padding:10px 14px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--accent),var(--accent2));color:#021125;font-weight:700;cursor:pointer}
    .select.secondary{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);font-weight:600}

    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:18px;margin-top:22px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);border-radius:14px;padding:14px;border:1px solid rgba(255,255,255,0.03);box-shadow:0 6px 20px rgba(2,17,30,0.5);transition:transform .28s ease,box-shadow .28s;overflow:hidden}
    .card:hover{transform:translateY(-8px);box-shadow:0 30px 60px rgba(2,17,30,0.6)}
    .card-head{display:flex;align-items:center;gap:12px}
    .card-title{font-weight:700;font-size:15px}
    .badge{margin-left:auto;background:rgba(255,255,255,0.03);padding:6px 10px;border-radius:999px;font-size:13px;color:var(--muted);}
    .links{margin-top:10px;display:flex;flex-direction:column;gap:8px;max-height:280px;overflow:auto;padding-right:6px}

    .link{display:flex;align-items:center;gap:12px;padding:10px;border-radius:10px;background:rgba(255,255,255,0.01);transition:background .15s;cursor:pointer;border:1px solid rgba(255,255,255,0.01)}
    .link:hover{background:linear-gradient(90deg, rgba(0,255,255,0.03), rgba(123,97,255,0.03))}
    .link .favicon{width:36px;height:36px;border-radius:8px;background:rgba(255,255,255,0.03);display:flex;align-items:center;justify-content:center;font-weight:700}
    .link .meta{flex:1}
    .link .meta .host{font-weight:700}
    .link .meta .path{font-size:13px;color:var(--muted);margin-top:3px}
    .link .status{display:flex;gap:8px;align-items:center;font-weight:700}
    .dot{width:10px;height:10px;border-radius:999px}

    .offline{color:var(--bad)}
    .online{color:var(--good)}

    /* animations */
    .fadeIn{animation:fadeIn .5s ease both}
    @keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}

    footer{max-width:1200px;margin:40px auto 80px;padding:0 20px;color:var(--muted);font-size:13px;text-align:center}

    /* responsive tweaks */
    @media (max-width:760px){.grid{grid-template-columns:repeat(auto-fill,minmax(260px,1fr))}}
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo">UH</div>
      <div>
        <h1>Unblock Hub 2025 ‚Äî Professional</h1>
        <div style="font-size:12px;color:var(--muted)">1000+ resources ‚Ä¢ optimized checks ‚Ä¢ animated UI</div>
      </div>
    </div>

    <div class="header-right">
      <div class="pill" title="Realtime active sessions">
        <div class="pulse" id="pulse"></div>
        <div id="onlineDisplay">...</div>
      </div>
      <button class="btn" id="panicBtn" title="Quick panic (go to safe site)"><i class="fa-solid fa-fire"></i>&nbsp;Panic</button>
    </div>
  </header>

  <main>
    <div class="controls">
      <div class="search"><input id="q" placeholder="Search title, host, or path ‚Äî try 'google' or 'proxy'" autocomplete="off"></div>
      <select id="category" class="select secondary">
        <option value="all">All categories</option>
        <option value="proxies">Proxies</option>
        <option value="games">Games</option>
        <option value="streaming">Streaming</option>
        <option value="tools">Tools</option>
      </select>
      <button class="select" id="randomBtn">Random Working</button>
      <button class="select secondary" id="refreshBtn">Re-check visible</button>
    </div>

    <div id="grid" class="grid"></div>
  </main>

  <footer>Built with ‚ù§Ô∏è ‚Äî Use responsibly. Press <kbd>Esc</kbd> or the Panic button to jump to a safe site.</footer>

  <script>
  /*****************************************************************
   * HOW THIS BUILD WORKS
   * - UI: animated, modern grid/cards
   * - Link checks: 3 independent probes (CORS HEAD via proxy, image ping, fetch no-cors) to reduce false negatives
   * - Online counter: 3 modes
   *     1) If you provide Firebase config (see instructions below) it will use Realtime Database for accurate, scalable realtime counts
   *     2) If you host a Socket.IO server, there's a Socket.IO client fallback (server code provided in comments)
   *     3) Otherwise: fallback "best-effort" using seeyoufarm hits + local presence with short polling (not perfectly global)
   * - No external API keys required for checks; optional Firebase gives highest accuracy for presence.
   *****************************************************************/

  // -------------------------
  // Paste your sites array here (or dynamically load it later)
  // For now this is a small demo set ‚Äî replace with your full list.
  const sites = [
    {id:'rosin', title:'ROSIN', category:'proxies', links:['http://trzxvycsql.kionom.biz/','https://www.croxyproxy.com/']},
    {id:'coolmath', title:'Coolmath', category:'games', links:['https://coolmathgames.com']},
    {id:'youtube', title:'YouTube', category:'streaming', links:['https://youtube.com']},
    {id:'khan', title:'Khan Academy', category:'tools', links:['https://khanacademy.org']}
  ];

  // -------------------------
  // Utility helpers
  const $ = sel => document.querySelector(sel);
  const $$ = sel => Array.from(document.querySelectorAll(sel));
  const uid = (s) => s.replace(/[^a-z0-9_-]/gi,'_');

  // -------------------------
  // Multi-probe link health check
  // Probes (ordered):
  //  1) CORS proxy GET -> usually reliable (uses api.allorigins.win)
  //  2) Image ping (create Image() with timeout)
  //  3) fetch HEAD with mode:no-cors (best-effort)
  // Each probe returns true/false; final verdict uses majority (>=2 successes) or any success if only one probe possible.

  async function probe_corsproxy(url, timeout=6000) {
    try {
      const proxy = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(url);
      const controller = new AbortController();
      const timer = setTimeout(()=>controller.abort(), timeout);
      const r = await fetch(proxy, {method:'GET',signal:controller.signal});
      clearTimeout(timer);
      return r.ok;
    } catch(e){ return false; }
  }

  function probe_image(url, timeout=4500){
    // try favicon or root
    return new Promise(res=>{
      try{
        const img = new Image();
        let done=false;
        const t = setTimeout(()=>{ if(!done){done=true; img.src=''; res(false);} },timeout);
        img.onload = ()=>{ if(!done){done=true; clearTimeout(t); res(true);} };
        img.onerror = ()=>{ if(!done){done=true; clearTimeout(t); res(false);} };
        img.referrerPolicy = 'no-referrer';
        // try favicon first
        const u = new URL(url);
        img.src = u.origin + '/favicon.ico?cache=' + Date.now();
      }catch(e){ res(false); }
    });
  }

  async function probe_fetch_no_cors(url, timeout=4000){
    try{
      const controller = new AbortController();
      const timer = setTimeout(()=>controller.abort(), timeout);
      // no-cors will succeed if TCP connection occurs (no CORS error thrown here in many browsers), so success often indicates reachable
      await fetch(url, {method:'GET',mode:'no-cors',signal:controller.signal});
      clearTimeout(timer);
      return true;
    }catch(e){ return false; }
  }

  async function isWorking(url){
    // run probes in parallel but cap time
    const probes = [probe_corsproxy(url), probe_image(url), probe_fetch_no_cors(url)];
    const results = await Promise.allSettled(probes);
    const oks = results.filter(r=>r.status==='fulfilled' && r.value).length;
    return oks >= 1; // be permissive (1/3) to avoid false negatives; you can raise to 2 for stricter
  }

  // Cache results to avoid repeated checks
  const healthCache = new Map();

  async function checkAndSet(elStatus, url){
    elStatus.textContent = 'Checking...';
    elStatus.className = '';
    try{
      // use cached if fresh
      const cached = healthCache.get(url);
      if(cached && Date.now() - cached.t < 1000*60*5){ // 5 minutes
        setStatus(elStatus, cached.ok);
        return cached.ok;
      }

      const ok = await isWorking(url);
      healthCache.set(url, {ok, t: Date.now()});
      setStatus(elStatus, ok);
      return ok;
    }catch(e){ setStatus(elStatus,false); return false; }
  }

  function setStatus(el, ok){
    el.textContent = ok ? 'Online' : 'Offline';
    el.className = ok ? 'status online' : 'status offline';
    const dot = el.querySelector('.dot');
    if(dot) dot.style.background = ok ? 'var(--good)' : 'var(--bad)';
  }

  // -------------------------
  // Render functions
  function renderSites(list){
    const grid = $('#grid'); grid.innerHTML = '';
    list.forEach(site=>{
      const card = document.createElement('div'); card.className='card fadeIn';
      const total = site.links.length;
      card.innerHTML = `
        <div class="card-head">
          <div style="width:52px;height:52px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:800;color:#021125">${(site.title||'S').slice(0,2)}</div>
          <div style="margin-left:6px">
            <div class="card-title">${site.title}</div>
            <div style="font-size:13px;color:var(--muted);margin-top:6px">${site.category.toUpperCase()} ‚Ä¢ ${total} links</div>
          </div>
          <div class="badge">${site.category}</div>
        </div>
        <div class="links" id="links-${uid(site.id)}"></div>
      `;
      grid.appendChild(card);

      const listEl = card.querySelector('#links-'+uid(site.id));
      site.links.forEach(l => {
        const a = document.createElement('a'); a.className='link'; a.href=l; a.target='_blank';
        const host = (l.replace(/^https?:\/\//,'')).split('/')[0];
        a.innerHTML = `
          <div class="favicon">${host[0]?.toUpperCase()||'üåê'}</div>
          <div class="meta">
            <div class="host">${host}</div>
            <div class="path">${l.replace(/^https?:\/\//,'').slice(host.length)}</div>
          </div>
          <div class="status" id="stat-${btoa(l).replace(/=/g,'')}"><div class="dot" style="background:rgba(255,255,255,0.06)"></div><div style="margin-left:6px;color:var(--muted);font-weight:600">Unknown</div></div>
        `;
        listEl.appendChild(a);

        // attach click to open + one-time quick ping
        a.addEventListener('mouseenter', ()=>{
          // lazy-check on hover after short debounce
          if(!healthCache.has(l)) checkAndSet(a.querySelector('.status'), l);
        });

        a.addEventListener('click', async (e)=>{
          const ok = await checkAndSet(a.querySelector('.status'), l);
          if(!ok){
            // let the user decide, still open
            const openAnyway = confirm('This link looks offline. Open anyway?');
            if(!openAnyway){ e.preventDefault(); }
          }
        });

      });
    });
  }

  // initial render
  renderSites(sites);

  // -------------------------
  // Controls
  $('#q').addEventListener('input', ()=>filterAndRender());
  $('#category').addEventListener('change', ()=>filterAndRender());
  $('#refreshBtn').addEventListener('click', ()=>refreshVisible());
  $('#randomBtn').addEventListener('click', pickRandomWorking);
  $('#panicBtn').addEventListener('click', ()=>{ window.location.href='https://www.google.com'; });

  function filterAndRender(){
    const q = $('#q').value.toLowerCase();
    const cat = $('#category').value;
    const filtered = sites.filter(s=> (cat==='all'||s.category===cat) && (s.title.toLowerCase().includes(q) || s.links.some(l=>l.toLowerCase().includes(q))));
    renderSites(filtered);
  }

  async function refreshVisible(){
    // check all visible statuses
    const statusEls = Array.from(document.querySelectorAll('.links .status'));
    for(const el of statusEls){
      const encoded = el.id.replace('stat-','');
      try{
        const url = atob(encoded.replace(/_/g,'/').replace(/-/g,'=')); // careful: encoding earlier
      }catch(e){ /* ignore */ }
    }
    // simpler: re-run checks for visible links via their anchor href
    const anchors = Array.from(document.querySelectorAll('.links .link'));
    for(const a of anchors){
      const href = a.href;
      const s = a.querySelector('.status');
      await checkAndSet(s, href);
    }
    alert('Visible links rechecked (cached results avoided where expired).');
  }

  async function pickRandomWorking(){
    // pick random link across proxies only
    const all = sites.filter(s=>s.category==='proxies').flatMap(s=>s.links);
    if(!all.length){ alert('No proxies in dataset yet'); return; }
    // shuffle
    for(let i=0;i<all.length;i++){ const j=Math.floor(Math.random()*all.length); [all[i],all[j]]=[all[j],all[i]]; }
    for(const url of all){
      const ok = await checkAndSet(document.createElement('div'), url); // silent check
      if(ok){ window.open(url,'_blank'); return; }
    }
    alert('No working proxies found (try re-checking later).');
  }

  // -------------------------
  // ONLINE COUNTER
  // We provide 3 modes. By default, the script will try to use Firebase if you paste a config into `FIREBASE_CONFIG` below.
  // If not provided, it will fall back to a best-effort method using a public hits counter + localStorage. For the most accurate real-time shared counts, run the small Node.js Socket.IO server included in comments and flip USE_SOCKET to true & set SOCKET_URL.

  const FIREBASE_CONFIG = {
    apiKey: "AIzaSyBklXRtT5KksQKF5IovensuRF5e-ylSlfw",
    authDomain: "idk-bro-d9f4a.firebaseapp.com",
    projectId: "idk-bro-d9f4a",
    storageBucket: "idk-bro-d9f4a.firebasestorage.app",
    messagingSenderId: "635073581328",
    appId: "1:635073581328:web:4c24862356303a0ad1d595",
    measurementId: "G-EW8MQLFYH7"
  }; // <-- Paste Firebase config object here for realtime DB mode, example below in comments.
  const USE_SOCKET = false; // set true if you have a Socket.IO server running and SOCKET_URL set
  const SOCKET_URL = 'https://your-socket-server.example';

  // FALLBACK: best-effort using seeyoufarm badge + local session tracking
  async function fallbackPresence(){
    // increment a badge (not authoritative) then use localStorage for session uniqueness
    const key = 'uh_session_' + Math.floor(Date.now()/1000/60); // new every minute to limit double count
    if(!localStorage.getItem(key)){
      // ping hits.seeyoufarm badge (this increments their count for the url param but not ideal)
      const img = new Image(); img.src = 'https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=unblockhub2025&t=' + Date.now();
      localStorage.setItem(key,'1');
    }
    // estimate online as number of clients in last 5 minutes stored in localStorage
    const now = Date.now();
    const sessions = JSON.parse(localStorage.getItem('uh_sessions')||'[]');
    // remove old
    const fresh = sessions.filter(s=> now - s < 1000*60*10); // 10 minutes
    fresh.push(now);
    localStorage.setItem('uh_sessions', JSON.stringify(fresh));
    $('#onlineDisplay').textContent = fresh.length + ' (est)';
    return fresh.length;
  }

  // Try Firebase realtime DB presence
  async function firebasePresence(config){
    // dynamic load firebase
    const s = document.createElement('script'); s.src = 'https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js'; document.head.appendChild(s);
    const s2 = document.createElement('script'); s2.src = 'https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js'; document.head.appendChild(s2);
    await new Promise(r=>s2.onload=r);
    // init
    const app = firebase.initializeApp(config);
    const db = firebase.database();
    const ref = db.ref('presence/unblockhub');
    const myRef = ref.push();
    myRef.set({ts:Date.now()});
    myRef.onDisconnect().remove();
    ref.on('value', snap => {
      const v = snap.val() || {};
      const count = Object.keys(v).length;
      $('#onlineDisplay').textContent = count + ' users';
    });
  }

  // Socket.IO presence (requires server)
  function socketPresence(url){
    const s = document.createElement('script'); s.src='https://cdn.socket.io/4.7.2/socket.io.min.js'; document.head.appendChild(s);
    s.onload = ()=>{
      const socket = io(url);
      socket.on('connect', ()=>{
        socket.emit('join','unblockhub');
      });
      socket.on('presence', data => {
        $('#onlineDisplay').textContent = data.count + ' users';
      });
    }
  }

  // bootstrap presence
  (async ()=>{
    if(FIREBASE_CONFIG){ try{ // enable anonymous auth for secure presence
    firebase.auth().signInAnonymously().catch(console.warn);
    await firebasePresence(FIREBASE_CONFIG); return; }catch(e){ console.warn('Firebase failed',e); } }
    if(USE_SOCKET && SOCKET_URL){ try{ socketPresence(SOCKET_URL); return; }catch(e){ console.warn('Socket failed',e); } }
    // fallback loop
    await fallbackPresence();
    setInterval(fallbackPresence, 15000);
  })();

  // -------------------------
  // Developer notes & server code (optional)
  // If you want a truly accurate realtime counter without relying on third parties, run this simple Node.js Socket.IO server.
  // Node server (save as server.js):
  /*
    const express = require('express');
    const http = require('http');
    const { Server } = require('socket.io');
    const app = express();
    const server = http.createServer(app);
    const io = new Server(server, { cors:{ origin:'*' } });
    const rooms = {};
    io.on('connection', socket => {
      socket.on('join', room => {
        socket.join(room);
        io.to(room).emit('presence',{count: io.sockets.adapter.rooms.get(room)?.size || 0});
      });
      socket.on('disconnecting', () => {
        socket.rooms.forEach(room => {
          setTimeout(()=> io.to(room).emit('presence',{count: io.sockets.adapter.rooms.get(room)?.size || 0}),100);
        });
      });
    });
    server.listen(3000, ()=> console.log('listening 3000'));
  */

  // -------------------------
  // Accessibility: keyboard panic (Esc)
  document.addEventListener('keydown', e=>{ if(e.key==='Escape'){ window.location.href='https://www.google.com'; } });

  </script>
</body>
</html>
